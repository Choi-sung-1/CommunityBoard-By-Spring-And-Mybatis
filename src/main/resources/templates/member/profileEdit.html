<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ë§ˆì´í˜ì´ì§€ ìˆ˜ì •</title>
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet" />
    <style>
        body {
            background-color: #f5f7fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .card {
            max-width: 500px; /* ë„“ê²Œ ì¡°ì • */
            margin: 60px auto;
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .card-header {
            background-color: #4e73df;
            color: white;
            font-weight: 700;
            font-size: 1.5rem;
            text-align: center;
            border-radius: 0.75rem 0.75rem 0 0;
            padding: 1rem;
        }

        .img-preview {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 50%;
            box-shadow: 0 0 8px rgba(0,0,0,0.15);
        }

        .field-error {
            color: #e74a3b;
            font-size: 0.875rem;
            margin-top: 4px;
        }

        .form-floating > .form-control.is-invalid ~ label {
            color: #e74a3b;
        }

        .btn-custom {
            border-radius: 0.5rem;
            font-weight: 600;
            padding: 0.6rem 1.2rem;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: #4e73df;
            border: none;
            color: white;
        }

        .btn-primary:hover {
            background-color: #2e59d9;
        }

        .btn-outline-secondary {
            border-color: #858796;
            color: #858796;
            background-color: transparent;
        }

        .btn-outline-secondary:hover {
            background-color: #858796;
            color: white;
        }

        .d-flex > .btn {
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>

<div class="card">
    <div class="card-header">
        ğŸ‘¥ ë§ˆì´í˜ì´ì§€ ìˆ˜ì •
    </div>
    <div class="card-body text-center">
        <form method="post" enctype="multipart/form-data"
              th:action="@{/member/profile/edit/{memberId}(memberId=${memberId})}"
              th:object="${memberProfile}">

            <!-- í”„ë¡œí•„ ì´ë¯¸ì§€ -->
            <div class="mb-4 text-center">
                <img th:src="${filePath}" src="ì²¨ë¶€ ì´ë¯¸ì§€" alt="í”„ë¡œí•„ ì´ë¯¸ì§€"
                     id="profileImage" class="img-preview mb-2" />
                <div class="mt-3" id="previewCard" style="display:none;">
                    <img id="preview" src="" alt="ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€" class="img-preview d-block mx-auto" />
                </div>
                <input class="form-control mt-2" type="file" name="profileImage" id="pfImage" accept="image/*" onchange="previewImage(event)" />
            </div>

            <!-- í•œì¤„ ì†Œê°œ -->
            <div class="form-floating mb-3">
                <input type="text" id="profileOneLineBio" name="profileOneLineBio"
                       th:value="*{profileOneLineBio}" class="form-control" placeholder="í•œì¤„ ì†Œê°œ" />
                <label for="profileOneLineBio">í•œì¤„ ì†Œê°œ</label>
            </div>

            <!-- ì´ë¦„ -->
            <div class="form-floating mb-3">
                <input type="text" th:field="*{memberName}" class="form-control" id="memberName" placeholder="ì´ë¦„"/>
                <label for="memberName">ì´ë¦„</label>
                <div class="field-error" id="nameError"></div>
            </div>

            <!-- ì•„ì´ë”” -->
            <div class="form-floating mb-3">
                <input type="text" th:field="*{memberLoginId}" class="form-control" readonly placeholder="ì•„ì´ë””"/>
                <label>ì•„ì´ë””</label>
            </div>

            <!-- ì´ë©”ì¼ -->
            <div class="form-floating mb-3">
                <input type="email" id="memberEmail" th:field="*{memberEmail}" class="form-control" placeholder="ì´ë©”ì¼" />
                <label for="memberEmail">ì´ë©”ì¼</label>
                <div class="field-error" id="emailError"></div>
            </div>

            <!-- ìƒë…„ì›”ì¼ -->
            <div class="form-floating mb-3">
                <input type="text" th:value="*{memberBirth}" class="form-control" readonly placeholder="ìƒë…„ì›”ì¼"/>
                <label>ìƒë…„ì›”ì¼</label>
            </div>

            <!-- ì „í™”ë²ˆí˜¸ -->
            <div class="form-floating mb-3">
                <input type="text" id="memberPhone" th:field="*{memberPhone}" class="form-control" placeholder="010-1234-5678" />
                <label for="memberPhone">ì „í™”ë²ˆí˜¸</label>
                <div class="field-error" id="phoneError"></div>
            </div>

            <!-- ë²„íŠ¼ -->
            <div class="d-flex justify-content-between mt-4">
                <button type="button" class="btn btn-outline-secondary btn-custom w-50 me-2" onclick="history.back()">â† ì·¨ì†Œ</button>
                <button type="submit" class="btn btn-primary btn-custom w-50">ìˆ˜ì •í•˜ê¸°</button>
            </div>

        </form>
    </div>
</div>

<script>
    function previewImage(event){
        const file = event.target.files[0];
        const reader = new FileReader();
        const originalImage = document.getElementById('profileImage');
        originalImage.hidden = true;

        reader.onload = function (e){
            const preview = document.getElementById("preview");
            const previewCard = document.getElementById("previewCard");
            preview.src = e.target.result;
            previewCard.style.display="block";
        };
        if(file){.
            reader.readAsDataURL(file);
        }
    }

    function validator(event) {
        let isValid = true;

        // ì´ë¦„ ê²€ì¦
        const nameInput = document.getElementById("memberName");
        const nameError = document.getElementById("nameError");
        const name = nameInput.value.trim();
        if (name.length < 2) {
            nameError.textContent = "ì´ë¦„ì€ ìµœì†Œ 2ì ì´ìƒ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.";
            nameInput.classList.add("is-invalid");
            isValid = false;
        } else {
            nameError.textContent = "";
            nameInput.classList.remove("is-invalid");
        }

        // ì „í™”ë²ˆí˜¸ ê²€ì¦
        const phoneInput = document.getElementById("memberPhone");
        const phoneError = document.getElementById("phoneError");
        const phone = phoneInput.value.trim();
        const phoneRegex = /^010-\d{4}-\d{4}$/;

        if (phone !== "" && !phoneRegex.test(phone)) {
            phoneError.textContent = "ì „í™”ë²ˆí˜¸ëŠ” 010-1234-5678 í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤.";
            phoneInput.classList.add("is-invalid");
            isValid = false;
        } else {
            phoneError.textContent = "";
            phoneInput.classList.remove("is-invalid");
        }

        // ì´ë©”ì¼ ê²€ì¦
        const emailInput = document.getElementById("memberEmail");
        const emailError = document.getElementById("emailError");
        const email = emailInput.value.trim();
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (email !=="" && !emailRegex.test(email)) {
            emailError.textContent = "ìœ íš¨í•œ ì´ë©”ì¼ í˜•ì‹ì„ ì…ë ¥í•˜ì„¸ìš”.";
            emailInput.classList.add("is-invalid");
            isValid = false;
        } else {
            emailError.textContent = "";
            emailInput.classList.remove("is-invalid");
        }

        if (!isValid) {
            event.preventDefault();
        }
    }

    document.addEventListener("DOMContentLoaded", function () {
        const form = document.querySelector("form");
        form.addEventListener("submit", validator);
    });
</script>

</body>
</html>
x